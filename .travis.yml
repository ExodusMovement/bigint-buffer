language: node_js
node_js:
- node
- '10'
env:
  global:
  - DISPLAY=:99.0
  - secure: rfmdSfKCkKp7AgZAMox2RQp6taCDDvsy3jvpXp3zF47izl2xQ6L4s14UHMRijx5yA/l5L47CBVE5U4rliprBf/qzSdWPtpxIkTAoWzHHiZ2OfDLuXhZGQt15M/URBUDAw1IYyzwyaQTu0r1cnD3bN88I0Zo/h4lID7aK0+dV+sLMtxHcGvh3/kBEq+JosGnjqJ9lYJdVlHFyShIQgZgLSTHG6aBQK6FnHU0STViCA75i9MFuLrP5X/rT3nxaardMzcCpCWftepN2EgV/IxjWCa/apHa0kRE8yI0tx/hK9nsDWYBQIavTeJ8YoB6F03gQGDAIMaRuKpUCHf0aJcJgL1TaIE+tRqluMEriAwGKPztdLkzi7rBCdSrkry0SWLw2rwBqnRdgTdSAbbw+4sWLZGqNqqX9m/SD53xfry8IZghSKmjBh33aOZj9vZMsj+YAwUMN/ZDALN5T1f9xCoEDG+B3oFEQZmCDWaDGn/HOo5WT5Qpur7xLUr0p9Fx25IVn1WYdq7zK4QktYr5TbTF7nnjh2Qz5M2+XT1zS9ZBN1nus5+flaMKisbgM4L2+S5Ua/81m0+yqczYmWK4kiw2r4AKwFmqXmAit7Yf9ceW+6ev78295lyg95QRZc90sxMkc11jbE/bbkXrbGVQrRRg5sk4IaYbK89p5exeaCkVmebw=
  - secure: SbO2vQjiqYiTbquwVqQpQPuoH4E26zwnOH9mz0/i4GpekkWM++458gdzcR+HpyLBj+yGDiZl7He4/BMs6zAR+9Vy8Yy1+gZZ9ws/x0CqMlrQExLO7Fjl6dVN3wXvzEcdsK26KiwH6jXjna2lpXj+uima/49EJZSPy9EocgD1pDP32RpSkmwMgnuX/sLVC0rjMTf23nMXAznP46wiFxbJtPNksV0sVYRtqqX14sTP1nBAvJeobQwMJW68qD73KOuB2GQ/oVGszIdxEEPY1FBJigrlhL5DUMkPiJFHxuTCWjOnkTMVEa0XE2AzCV53l9d9lIEfTTV81u4creaIc7axN4oYIM6qlQNXnHgdlAZ+BWD5x818RIZ/1cjG+jtMdmPIM+OcA9qanzVPAeDDJu8cSNRB6I4RLJ9h89sPfI/Z7DMYhXPCMJ7f6exoRkmuh9A9N6ijTQh2PMzRXxkew9dgF342cREFGpuT9zQiy9DeAiaZFYETLHbfd6hk2oHxH9fMndonVGUp4olePN8W8MoX1Wu9RBD9OBvoeB13muyVWVGY2Bo5Q09Bsa33xRUJC0uXpd/NXhlOZWVHDCGMgPbBxzbOeEPR1t8U5FyDvU4+Uzp5e4lGiWI1urXnvx9SWXZdaTC8brtg+IDx5ljvac9c9VRMNiJm9c+gRkQwlUNb1P0=
  matrix:
  - CXX=g++-4.8 TEST_SUITE=test:node
addons:
  chrome: stable
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
before_install:
- sh -e /etc/init.d/xvfb start
matrix:
  fast_finish: true
  include:
  - os: linux
    node_js: '10'
    env: CXX=g++-4.8 TEST_SUITE=test:browser
before_script:
- npm install -g typescript gts typedoc
script: npm run $TEST_SUITE
before_deploy:
- npm run typedoc
- npm pack
deploy:
- provider: pages
  skip-cleanup: true
  github-token: "$GITHUB_TOKEN"
  keep-history: true
  local_dir: docs
  committer-from-gh: true
  on:
    branch: master
    node: '10'
    condition: "$TEST_SUITE = test:node"
- provider: releases
  api_key: "$GITHUB_TOKEN"
  file_glob: true
  file: bigint-buffer-*.tgz
  skip_cleanup: true
  on:
    branch: master
    node: '10'
    condition: "$TEST_SUITE = test:node"
    tags: true
- provider: npm
  api_key: "$NPM_TOKEN"
  skip_cleanup: true
  email: mwei@cs.ucsd.edu
  on:
    branch: master
    node: '10'
    condition: "$TEST_SUITE = test:node"
    tags: true
